"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[616],{5236:(W,U,l)=>{l.r(U),l.d(U,{default:()=>V});var e=l(4496),y=l(7408);const R={paginate:y.i,sort:{active:"id",direction:"asc"},users:[]};var x=l(3992),w=l(1568),p=l(1560),v=l(2156),h=l(440),Y=l(1528),m=l(2864),f=l(4060),i=l(6504),k=l(6056),T=l(8416),c=l(7816),$=l(3808),O=l(7760),g=l(8812),u=l(6716),D=l(7048);let b=(()=>{class r{constructor(t){this._httpClient=t}dataTableUser({length:t,pageIndex:a,pageSize:s},{active:o,direction:d}){return this._httpClient.post(`${u.O.apiUrl}/user/data-table`,{length:t,pageIndex:a,pageSize:s,active:o,direction:d})}userRequeriments(){return this._httpClient.get(`${u.O.apiUrl}/user/requeriment`)}userStore(t){return this._httpClient.post(`${u.O.apiUrl}/user`,t)}userUpdate(t){return this._httpClient.put(`${u.O.apiUrl}/user/${t.id}`,t)}userEdit(t){return this._httpClient.get(`${u.O.apiUrl}/user/${t}`)}userDelete(t){return this._httpClient.delete(`${u.O.apiUrl}/user/${t}`)}static#e=this.\u0275fac=function(a){return new(a||r)(e.CoB(D.KK))};static#t=this.\u0275prov=e.wxM({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var S=l(3576);function M(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Nombre requerido"),e.C$Y())}function F(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Celular requerido"),e.C$Y())}function N(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Email requerido"),e.C$Y())}function q(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Debe se un email"),e.C$Y())}function z(r,n){if(1&r&&(e.I0R(0,"mat-option",14),e.OEk(1),e.C$Y()),2&r){const t=n.$implicit;e.E7m("value",t.rol_id),e.yG2(),e.cNF(t.name)}}function A(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Roles es requerido"),e.C$Y())}function L(r,n){if(1&r){const t=e.KQA();e.I0R(0,"div",7)(1,"label",15),e.OEk(2,"Resetear contrase\xf1a"),e.C$Y(),e.wR5(3,"br",16),e.I0R(4,"div",17)(5,"mat-slide-toggle",18),e.qCj("change",function(){e.usT(t);const s=e.GaO();return e.CGJ(s.handlerChangeResetPassword())}),e.OEk(6," Resetear contrase\xf1a "),e.C$Y()()()}2&r&&(e.yG2(5),e.E7m("formControlName","reset_password"))}function Q(r,n){1&r&&(e.I0R(0,"mat-error"),e.OEk(1,"Contrase\xf1a es requerido"),e.C$Y())}function j(r,n){if(1&r&&(e.I0R(0,"div",7)(1,"mat-form-field",8)(2,"mat-label"),e.OEk(3,"Contrase\xf1a"),e.C$Y(),e.wR5(4,"input",9),e.yuY(5,Q,2,0,"mat-error"),e.C$Y()()),2&r){const t=e.GaO();let a;e.yG2(),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Contrase\xf1a")("formControlName","password"),e.yG2(),e.C0Y(5,null!=(a=t.formUser.get("password"))&&a.hasError("required")?5:-1)}}let B=(()=>{class r{constructor(t,a,s,o){this.data=t,this._matDialogRef=a,this._userService=s,this._snackBar=o,this.roles=(0,e.OCB)([]),this.formUser=new i.WC({id:new i.Ku(-1),name:new i.Ku("",[i.AQ.required]),email:new i.Ku("",[i.AQ.required,i.AQ.email]),roles:new i.Ku([],[i.AQ.required]),celular:new i.Ku("",[i.AQ.required]),reset_password:new i.Ku(!1),password:new i.Ku("",[i.AQ.required])}),t.edit||this.formUser.get("reset_password").setValue(!0),this.requirement(),this.handlerChangeResetPassword()}handlerSubmit(){this.formUser.valid?this.data.edit?(console.log("editar"),this.updateUser()):(console.log("store"),this.storeUser()):this.formUser.markAllAsTouched()}requirement(){var t=this;return(0,Y.c)(function*(){const a=yield(0,$.o)(t._userService.userRequeriments());t.roles.set(a.data.roles),t.data.edit&&t.editUser()})()}storeUser(){this._userService.userStore(this.formUser.value).subscribe(a=>{200===a.meta.code&&(this._snackBar.openSnackBar(a.meta.message),this._matDialogRef.close(this.data))})}updateUser(){this._userService.userUpdate(this.formUser.value).subscribe(a=>{200===a.meta.code&&(this._snackBar.openSnackBar(a.meta.message),this._matDialogRef.close(this.data))})}editUser(){this._userService.userEdit(this.data.user_id).subscribe(t=>{200===t.meta.code&&this.formUser.setValue(t.data)})}handlerChangeResetPassword(){!0===this.formUser.get("reset_password").value?(this.formUser.get("password").setValue(""),this.formUser.get("password").setValidators(i.AQ.required),this.formUser.get("password").updateValueAndValidity()):(this.formUser.get("password").setValidators(null),this.formUser.get("password").updateValueAndValidity())}static#e=this.\u0275fac=function(a){return new(a||r)(e.GI1(m.sR),e.GI1(m.yI),e.GI1(b),e.GI1(g.u))};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["app-modal-user"]],standalone:!0,features:[e.M5G([g.u]),e.UHJ],decls:40,vars:22,consts:[["mat-dialog-title","",1,"dialog-title","flex","justify-between"],[1,"text-2xl","w-full","mt-2","m-0","font-medium"],["mat-icon-button","","aria-label","close dialog","mat-dialog-close",""],["svgIcon","heroicons_outline:x-mark"],[3,"formGroup"],[1,"mat-typography"],[1,"grid","sm:grid-cols-1","md:grid-cols-4","lg:grid-cols-4","xl:grid-cols-4","gap-2"],[1,"col-span-2"],[1,"w-full",3,"floatLabel"],["matInput","",3,"placeholder","formControlName"],[3,"multiple","placeholder","formControlName"],["class","col-span-2"],[1,"flex","justify-end"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"click"],[3,"value"],[1,"text-neutral-900"],[1,""],[1,"py-2"],[1,"example-margin",3,"formControlName","change"]],template:function(a,s){if(1&a&&(e.I0R(0,"div",0)(1,"div",1),e.OEk(2),e.C$Y(),e.I0R(3,"button",2),e.wR5(4,"mat-icon",3),e.C$Y()(),e.I0R(5,"form",4)(6,"mat-dialog-content",5)(7,"div",6)(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),e.OEk(11,"Nombre completo"),e.C$Y(),e.wR5(12,"input",9),e.yuY(13,M,2,0,"mat-error"),e.C$Y()(),e.I0R(14,"div",7)(15,"mat-form-field",8)(16,"mat-label"),e.OEk(17,"Celular"),e.C$Y(),e.wR5(18,"input",9),e.yuY(19,F,2,0,"mat-error"),e.C$Y()(),e.I0R(20,"div",7)(21,"mat-form-field",8)(22,"mat-label"),e.OEk(23,"Email"),e.C$Y(),e.wR5(24,"input",9),e.yuY(25,N,2,0,"mat-error")(26,q,2,0,"mat-error"),e.C$Y()(),e.I0R(27,"div",7)(28,"mat-form-field",8)(29,"mat-label"),e.OEk(30,"Roles"),e.C$Y(),e.I0R(31,"mat-select",10),e.c53(32,z,2,2,"mat-option",14,e.wJt),e.C$Y(),e.yuY(34,A,2,0,"mat-error"),e.C$Y()(),e.yuY(35,L,7,1,"div",11)(36,j,6,4,"div",11),e.C$Y()(),e.I0R(37,"mat-dialog-actions",12)(38,"button",13),e.qCj("click",function(){return s.handlerSubmit()}),e.OEk(39," Guardar "),e.C$Y()()()),2&a){let o,d,C,I,G;e.yG2(2),e.cNF(s.data.name),e.yG2(3),e.E7m("formGroup",s.formUser),e.yG2(4),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Nombre completo")("formControlName","name"),e.yG2(),e.C0Y(13,null!=(o=s.formUser.get("name"))&&o.hasError("required")?13:-1),e.yG2(2),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Celular")("formControlName","celular"),e.yG2(),e.C0Y(19,null!=(d=s.formUser.get("celular"))&&d.hasError("required")?19:-1),e.yG2(2),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("placeholder","Email")("formControlName","email"),e.yG2(),e.C0Y(25,null!=(C=s.formUser.get("email"))&&C.hasError("required")?25:-1),e.yG2(),e.C0Y(26,null!=(I=s.formUser.get("email"))&&I.hasError("email")?26:-1),e.yG2(2),e.E7m("floatLabel","always"),e.yG2(3),e.E7m("multiple",!0)("placeholder","roles")("formControlName","roles"),e.yG2(),e.oho(s.roles()),e.yG2(2),e.C0Y(34,null!=(G=s.formUser.get("roles"))&&G.hasError("required")?34:-1),e.yG2(),e.C0Y(35,s.data.edit?35:-1),e.yG2(),e.C0Y(36,!0===s.formUser.get("reset_password").value?36:-1)}},dependencies:[p.oB,p.qL,m.WQ,m.iU,m.Yp,m.qq,m.sr,f.wb,f.Up,f.w5,f.wJ,k.d5,k.kX,S.I5,i.y,i.sz,i.ot,i.ue,i.u,T.cN,T.yi,i.sl,i.uW,i.Wo,c.oJ,c.Gw,c.um,O.cP],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return r})();var _=l(1725),E=l(1292);function J(r,n){if(1&r&&(e.I0R(0,"mat-chip",21),e.OEk(1),e.C$Y()),2&r){const t=n.$implicit;e.yG2(),e.cNF(t)}}function P(r,n){if(1&r){const t=e.KQA();e.I0R(0,"div",12)(1,"div",13),e.OEk(2),e.C$Y(),e.I0R(3,"div",14),e.OEk(4),e.C$Y(),e.I0R(5,"div",14),e.OEk(6),e.C$Y(),e.I0R(7,"div",15),e.c53(8,J,2,1,"mat-chip",22,e.wJt),e.C$Y(),e.I0R(10,"div",16)(11,"button",17),e.qCj("click",function(){const o=e.usT(t).$implicit,d=e.GaO();return e.CGJ(d.handlerOpenModalUser({edit:!0,user_id:o.id,name:"Editar User"}))}),e.wR5(12,"mat-icon",18),e.C$Y(),e.I0R(13,"button",19),e.qCj("click",function(){const o=e.usT(t).$implicit,d=e.GaO();return e.CGJ(d.handlerOpenDeleteUser(o.id))}),e.wR5(14,"mat-icon",20),e.C$Y()()()}if(2&r){const t=n.$implicit,a=e.GaO();e.yG2(2),e.oRS(" ",t.name," "),e.yG2(2),e.oRS(" ",t.email," "),e.yG2(2),e.oRS(" ",t.celular," "),e.yG2(2),e.oho(a.rolesToArray(t.roles)),e.yG2(5),e.E7m("color","warn")}}let K=(()=>{class r{constructor(t,a,s,o){this._matDialog=t,this._confirmation=a,this._userService=s,this._snackBar=o,this.initialPagination=y.i,this.dataTableUser=e.YhN.required(),this.reloadDataTableUser=new e._w7}handleSorts(){this.dataTableUser().sort.active=this._sort.active,this.dataTableUser().sort.direction=this._sort.direction,this.reloadDataTableUser.emit(this.dataTableUser())}handlePageEvent(t){this.dataTableUser().paginate.length=t.length,this.dataTableUser().paginate.pageIndex=t.pageIndex,this.dataTableUser().paginate.pageSize=t.pageSize,this.reloadDataTableUser.emit(this.dataTableUser())}handlerOpenModalUser(t){this._matDialog.open(B,{width:"800px",data:t}).afterClosed().subscribe(a=>{void 0!==a&&this.reloadDataTableUser.emit(this.dataTableUser())})}rolesToArray(t){return t.split(",")}handlerOpenDeleteUser(t){console.log("handlerDeleteUser",t),this._confirmation.confirmation({title:"Eliminar",message:"Esta seguro de eliminar este usuario?",icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"success"},actions:{confirm:{show:!0,label:"Si",color:"warn"},cancel:{show:!0,label:"Cancelar"}},dismissible:!0}).afterClosed().subscribe(a=>{"confirmed"==a&&this.handlerDeleteUser(t)})}handlerDeleteUser(t){this._userService.userDelete(t).subscribe(a=>{200===a.meta.code&&(this._snackBar.openSnackBar(a.meta.message),this.reloadDataTableUser.emit(this.dataTableUser()))})}static#e=this.\u0275fac=function(a){return new(a||r)(e.GI1(m.qW),e.GI1(E.Q),e.GI1(b),e.GI1(g.u))};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["data-table-user"]],viewQuery:function(a,s){if(1&a&&(e.CC$(v.Qb,5),e.CC$(h.E9,5)),2&a){let o;e.wto(o=e.Gqi())&&(s._paginator=o.first),e.wto(o=e.Gqi())&&(s._sort=o.first)}},inputs:{dataTableUser:[e.Wk5.SignalBased,"dataTableUser"]},outputs:{reloadDataTableUser:"reloadDataTableUser"},standalone:!0,features:[e.M5G([E.Q,g.u]),e.UHJ],decls:21,vars:11,consts:[[1,"flex","justify-end","px-4","py-2","bg-card"],["mat-flat-button","","type","button",1,"",3,"color","disabled","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],[1,"grid","border"],["matSort","","matSortDisableClear","",1,"movement-grid","grid","xs:grid-cols-2","sm:grid-cols-3","md:grid-cols-5","lg:grid-cols-5","xl:grid-cols-5","z-10","sticky","top-0","gap-2","py-4","px-6","md:px-8","shadow","font-semibold","text-secondary","bg-gray-50","dark:dark:bg-neutral-900","dark:bg-opacity-5"],[1,"truncate","xs:truncate","sm:truncate","md:block","lg:block","xl:block",3,"mat-sort-header","click"],[1,"hidden","xs:hidden","sm:block","md:block","lg:block","xl:block",3,"mat-sort-header","click"],[1,"hidden","xs:hidden","sm:hidden","md:hidden","lg:block","xl:block",3,"mat-sort-header","click"],[1,"truncate","xs:truncate","sm:truncate","md:block","lg:block","xl:block"],[1,"flex","flex-auto","flex-col","overflow-y-auto"],[1,"bg-gray-50","border-b","dark:bg-transparent","absolute","border-t","bottom-0","inset-x-0","z-10",3,"length","pageIndex","pageSize","pageSizeOptions","page"],[1,"movement-grid","grid","xs:grid-cols-2","sm:grid-cols-3","md:grid-cols-5","lg:grid-cols-5","xl:grid-cols-5","items-center","gap-2","py-3","px-6","md:px-8","border-b"],[1,"truncate","xs:truncate","sm:block","md:block","lg:block","xl:block"],[1,"hidden","xs:truncate","sm:block","md:block","lg:block","xl:block"],[1,"hidden","xs:hidden","sm:hidden","md:block","lg:block","xl:block"],[1,"truncate","xs:truncate","md:block","lg:block","xl:block"],["mat-icon-button","",3,"click"],["svgIcon","heroicons_solid:arrow-top-right-on-square"],["mat-icon-button","","matTooltip","Eliminar",1,"mx-1",3,"color","click"],["svgIcon","heroicons_outline:trash"],["cdkDrag","",1,"mx-1"],["class","mx-1","cdkDrag",""],["class","movement-grid grid xs:grid-cols-2 sm:grid-cols-3 md:grid-cols-5 lg:grid-cols-5 xl:grid-cols-5 items-center gap-2 py-3 px-6 md:px-8 border-b"]],template:function(a,s){1&a&&(e.I0R(0,"div",0)(1,"button",1),e.qCj("click",function(){return s.handlerOpenModalUser({edit:!1,user_id:-1,name:"Nuevo User"})}),e.wR5(2,"mat-icon",2),e.I0R(3,"span",3),e.OEk(4,"Nuevo Usuario"),e.C$Y()()(),e.I0R(5,"div",4)(6,"div",5)(7,"div",6),e.qCj("click",function(){return s.handleSorts()}),e.OEk(8," Nombre "),e.C$Y(),e.I0R(9,"div",7),e.qCj("click",function(){return s.handleSorts()}),e.OEk(10," Email "),e.C$Y(),e.I0R(11,"div",7),e.qCj("click",function(){return s.handleSorts()}),e.OEk(12," Celular "),e.C$Y(),e.I0R(13,"div",8),e.qCj("click",function(){return s.handleSorts()}),e.OEk(14," Roles "),e.C$Y(),e.I0R(15,"div",9),e.OEk(16," Acciones "),e.C$Y()(),e.I0R(17,"div",10),e.c53(18,P,15,4,"div",23,e.wJt),e.I0R(20,"mat-paginator",11),e.qCj("page",function(d){return s.handlePageEvent(d)}),e.C$Y()()()),2&a&&(e.yG2(),e.E7m("color","primary")("disabled",!1),e.yG2(),e.E7m("svgIcon","heroicons_outline:plus"),e.yG2(5),e.E7m("mat-sort-header","name"),e.yG2(2),e.E7m("mat-sort-header","email"),e.yG2(2),e.E7m("mat-sort-header","celular"),e.yG2(2),e.E7m("mat-sort-header","roles"),e.yG2(5),e.oho(s.dataTableUser().users),e.yG2(2),e.E7m("length",s.dataTableUser().paginate.length)("pageIndex",s.dataTableUser().paginate.pageIndex)("pageSize",s.dataTableUser().paginate.pageSize)("pageSizeOptions",s.initialPagination.PageSizeOption))},dependencies:[h.Su,h.E9,h.e6,p.qL,v.Qb,_.Gs,_.oH,c.oJ,c.Gw,c.um],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return r})();const V=[{path:"",component:(()=>{class r{constructor(t){this._userService=t,this.dataTableUser=(0,e.OCB)(R)}ngOnInit(){this.inizializeDataTable()}inizializeDataTable(){this._userService.dataTableUser(this.dataTableUser().paginate,this.dataTableUser().sort).pipe((0,x.U)(1)).subscribe(t=>{this.dataTableUser.set(t.data)})}handlerLoadDataTableUser(t){this.dataTableUser.set(t),this.inizializeDataTable()}static#e=this.\u0275fac=function(a){return new(a||r)(e.GI1(b))};static#t=this.\u0275cmp=e.In1({type:r,selectors:[["list-user"]],standalone:!0,features:[e.UHJ],decls:14,vars:3,consts:[[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","sm:justify-between","p-6","sm:py-12","md:px-8","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-slate-900"],[1,"mt-2"],[1,"text-3xl","md:text-4xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[3,"dataTableUser","reloadDataTableUser"]],template:function(a,s){1&a&&(e.I0R(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"a",3),e.OEk(5,"Dashboard"),e.C$Y()(),e.I0R(6,"div",4),e.wR5(7,"mat-icon",5),e.I0R(8,"a",6),e.OEk(9,"Usuarios y roles"),e.C$Y()()(),e.I0R(10,"div",7)(11,"h2",8),e.OEk(12," Usuarios y roles "),e.C$Y()()()(),e.I0R(13,"data-table-user",9),e.qCj("reloadDataTableUser",function(d){return s.handlerLoadDataTableUser(d)}),e.C$Y()),2&a&&(e.yG2(4),e.E7m("routerLink","/dashboard"),e.yG2(3),e.E7m("svgIcon","heroicons_mini:chevron-right"),e.yG2(6),e.E7m("dataTableUser",s.dataTableUser()))},dependencies:[w.ER,p.qL,K],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return r})()}]}}]);